/* DO NOT EDIT: File is auto-generated */
package <%= to_package(repository.imit.qualified_change_mapper_name) %>;

/**
 * Utility class that applies the changes to the entities defined by the "<%= repository.name %>" repository.
 */
@javax.annotation.Generated( "Domgen" )
@java.lang.SuppressWarnings( { "UnusedDeclaration", "JavaDoc", "PMD.UnusedPrivateField", "PMD.SingularField" } )
public final class <%= repository.imit.change_mapper_name %>
  implements replicant.ChangeMapper
{
<% repository.data_modules.select{|data_module| data_module.imit? }.each do |data_module| -%>
<% data_module.entities.select{|entity| entity.imit? && entity.concrete? }.each do |entity| -%>
  private static final int <%= Reality::Naming.uppercase_constantize(entity.qualified_name.gsub('.','_')) %>_TRANSPORT_ID = <%= entity.imit.transport_id %>;
<% end %>
<% end %>
<% repository.data_modules.select{|data_module| data_module.imit? }.each do |data_module|
%>  private final <%= data_module.imit.qualified_mapper_name %> _<%= Reality::Naming.camelize(data_module.name) %>;
<% end %>
  @javax.inject.Inject
  public <%= repository.imit.change_mapper_name%>( <%= repository.data_modules.select{|data_module| data_module.imit? }.collect { |data_module| "final #{data_module.imit.qualified_mapper_name} #{Reality::Naming.camelize(data_module.name)}" }.join(', ') %> )
  {
<% repository.data_modules.select{|data_module| data_module.imit? }.each do |data_module|
%>    _<%= Reality::Naming.camelize(data_module.name) %> = <%= Reality::Naming.camelize(data_module.name) %>;
<% end %>
  }

  @java.lang.Override
  @javax.annotation.Nonnull
  public java.lang.Object createEntity( @javax.annotation.Nonnull final replicant.EntitySchema entitySchema, final int id, @javax.annotation.Nonnull replicant.EntityChangeData data )
  {
    switch( entitySchema.getId() )
    {
<%
repository.data_modules.select { |data_module| data_module.imit? }.each do |data_module|
  data_module.entities.each do |entity|
    if entity.imit? && entity.concrete?
%>      case <%= Reality::Naming.uppercase_constantize(entity.qualified_name.gsub('.','_')) %>_TRANSPORT_ID: return _<%= Reality::Naming.camelize(entity.data_module.name) %>.create<%= entity.name %>( data );
<%
    end
  end
end
%>
      default: throw new IllegalArgumentException( "Unknown typeID = " + entitySchema.getId()  );
    }
  }

  @java.lang.Override
  public void updateEntity( @javax.annotation.Nonnull final replicant.EntitySchema entitySchema, @javax.annotation.Nonnull java.lang.Object entity, @javax.annotation.Nonnull replicant.EntityChangeData data )
  {
    switch( entitySchema.getId() )
    {
<%
repository.data_modules.select { |data_module| data_module.imit? }.each do |data_module|
  data_module.entities.each do |entity|
    if entity.imit? && entity.concrete?
%>      case <%= Reality::Naming.uppercase_constantize(entity.qualified_name.gsub('.','_')) %>_TRANSPORT_ID: _<%= Reality::Naming.camelize(entity.data_module.name) %>.update<%= entity.name %>( (<%= entity.arez.qualified_name %>) entity, data );
<%
    end
  end
end
%>
      default: throw new IllegalArgumentException( "Unknown typeID = " + entitySchema.getId()  );
    }
  }
}
