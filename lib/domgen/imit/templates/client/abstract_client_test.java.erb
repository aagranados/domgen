/* DO NOT EDIT: File is auto-generated */
package <%= to_package(repository.imit.qualified_abstract_client_test_name) %>;

@java.lang.SuppressWarnings( { "UnusedDeclaration" } )
@javax.annotation.Generated( "Domgen" )
public abstract class <%= repository.imit.abstract_client_test_name %>
  extends org.realityforge.guiceyloops.shared.AbstractSharedTest
  implements org.testng.IHookable
{
<% repository.imit.test_factories.each do |short_code, classname| -%>
  @javax.annotation.Nonnull
  @edu.umd.cs.findbugs.annotations.SuppressFBWarnings( "NP_NONNULL_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR" )
  protected <%= classname %> <%= short_code %>;
<% end -%>

  @Override
  public void run( final org.testng.IHookCallBack icb, final org.testng.ITestResult testResult )
  {
    org.realityforge.arez.Arez.context().safeAction( () -> icb.runTestMethod( testResult ) );
  }

  @org.testng.annotations.BeforeMethod
  public void preTest()
    throws Exception
  {
    org.realityforge.braincheck.BrainCheckTestUtil.setVerboseErrorMessages( true );
    org.realityforge.braincheck.BrainCheckTestUtil.setCheckInvariants( true );
    org.realityforge.braincheck.BrainCheckTestUtil.setCheckApiInvariants( true );

    org.realityforge.arez.ArezTestUtil.setEnableNames( true );
    org.realityforge.arez.ArezTestUtil.setPurgeReactionsWhenRunawayDetected( false );
    org.realityforge.arez.ArezTestUtil.setEnforceTransactionType( true );
    org.realityforge.arez.ArezTestUtil.setEnableSpy( true );
    org.realityforge.arez.ArezTestUtil.setProvider( null );

    super.preTest();
<% repository.imit.test_factories.each do |short_code, classname| -%>
    <%= short_code %> = s( <%= classname %>.class );
<% end -%>
  }

  @org.testng.annotations.AfterMethod
  protected void afterTest()
    throws Exception
  {
    super.postTest();
    org.realityforge.braincheck.BrainCheckTestUtil.setVerboseErrorMessages( false );
    org.realityforge.braincheck.BrainCheckTestUtil.setCheckInvariants( false );
    org.realityforge.braincheck.BrainCheckTestUtil.setCheckApiInvariants( false );

    org.realityforge.arez.ArezTestUtil.setEnableNames( false );
    org.realityforge.arez.ArezTestUtil.setPurgeReactionsWhenRunawayDetected( true );
    org.realityforge.arez.ArezTestUtil.setEnforceTransactionType( false );
    org.realityforge.arez.ArezTestUtil.setEnableSpy( false );
  }

  @java.lang.Override
  protected com.google.inject.Module[] getModules()
  {
    final java.util.ArrayList<com.google.inject.Module> modules = new java.util.ArrayList<>();
    java.util.Collections.addAll( modules, super.getModules() );
<% repository.imit.test_modules.keys.each do |name| -%>
    addModule( modules, new<%= name %>() );
<% end -%>
    return modules.toArray( new com.google.inject.Module[ modules.size() ] );
  }
<% repository.imit.test_modules.each_pair do |name, classname| -%>

  @javax.annotation.Nullable
  protected com.google.inject.Module new<%= name %>()
  {
    return new <%= classname %>();
  }
<% end -%>
<% repository.imit.test_class_contents.each do |content| -%>
<%= content -%>
<% end -%>
}
